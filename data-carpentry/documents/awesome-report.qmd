---
title: "My Awesome Report"
author: Bjorn
format: html
---

```{r}
#| label: setup
#| include: false
library(tidyverse)
library(here)

interviews <- read_csv(here("data/SAFI_clean.csv"), na = "NULL")
interviews_plotting <- read_csv(here("data_output/interviews_plotting.csv"))

percent_wall_type <- interviews_plotting %>% 
  filter(respondent_wall_type != "cement") %>% # take cement out (it's useless)
  count(village, respondent_wall_type) %>% # count the number of village and wall type per village
  group_by(village) %>% # group by village to calculate percentage of each wall type within each village
  mutate(percent = (n / sum(n) * 100)) %>% # percentage of each wall type within all wall types in village
  ungroup()
```


<!--
# Title
## Section
### Subsection
#### Subsubsection
##### etc

This is regular text.
-->

## Introduction section

This ***report*** uses the **tidyverse** package along with the *SAFI* dataset,
which has columns that include:

- village
- interview_date
- no_members
- years_liv
- respondent_wall_type
- rooms

Ordered list:

1. village
2. years_liv
3. rooms

Nested items:

- village
  + Name of village
- no_members
  * How many family members lived in a house

## Results

This report was last rendered on `r Sys.Date()`.

```{r}
#| label: tbl-mean-members
#| echo: false
#| message: false
#| tbl-cap: "This is a caption."
interviews %>% 
  filter(!is.na(memb_assoc)) %>% 
  group_by(village, memb_assoc) %>% 
  summarise(mean_no_membrs = mean(no_membrs)) %>% 
  knitr::kable(
    col.names = c("Village", "Member Association", "Mean number of members")
  )
```

Here is a figure proving everything!

```{r}
#| label: fig-my-first-plot
#| fig-cap: "A plot."
#| echo: false
percent_wall_type %>% 
  ggplot(aes(x = village, y = percent, fill = respondent_wall_type)) +
  geom_col(position = "dodge") +
  labs(x = "Village", y = "Percent Wall Type", fill = "Respondent Wall Type") +
  theme_minimal() +
  theme(
    panel.grid.major.x = element_blank(),
    text = element_text(size = 16),
    axis.text.x = element_text(angle = 45, hjust = 1, vjust = 1)
    ) # remove vertical gridlines
```


